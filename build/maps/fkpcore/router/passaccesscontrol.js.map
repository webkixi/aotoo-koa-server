{"version":3,"sources":["fkpcore/router/passaccesscontrol.js"],"names":["DEBUG","debug","AKSHOOKS","SAX","passaccess","oridata","get","ctx","Fetch","fkproute","query","passdata","passData","emit","data","post","request","body","headers","login","response","set","success","message","error","getData"],"mappings":";;;;;;;;;;;;;;;;;AAAA,IAAMA,QAAQC,MAAM,8BAAN,CAAd;AACA,IAAMC,WAAWC,IAAI,kBAAJ,CAAjB;;AAEA,SAASC,UAAT,CAAoBC,OAApB,EAA6B;AAC3B,SAAO;AACLC;AAAA,0FAAK,iBAAeC,GAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACkBC,MAAMF,GAAN,CAAUC,IAAIE,QAAd,EAAwBF,IAAIG,KAA5B,CADlB;;AAAA;AACCC,wBADD;;AAEHC,2BAAWV,SAASW,IAAT,CAAc,gBAAd,EAAgC,EAAEC,MAAMH,QAAR,EAAkBJ,QAAlB,EAAhC,KAA4DI,QAAvE;AAFG,iDAGIA,QAHJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAL;;AAAA;AAAA;AAAA;;AAAA;AAAA,OADK;;AAOLI;AAAA,2FAAM,kBAAeR,GAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACiBC,MAAMO,IAAN,CAAWR,IAAIE,QAAf,EAAyBF,IAAIS,OAAJ,CAAYC,IAArC,CADjB;;AAAA;AACAN,wBADA;;AAEJC,2BAAWV,SAASW,IAAT,CAAc,iBAAd,EAAiC,EAAEC,MAAMH,QAAR,EAAkBJ,QAAlB,EAAjC,KAA6DI,QAAxE;;AAFI,sBAGAA,YAAYA,SAAS,CAAT,CAHZ;AAAA;AAAA;AAAA;;AAIF,oBAAIA,SAAS,CAAT,EAAYO,OAAZ,CAAoBC,KAAxB,EAA8B;AAC5BZ,sBAAIa,QAAJ,CAAaC,GAAb,CAAiB,OAAjB,EAA0BV,SAAS,CAAT,EAAYO,OAAZ,CAAoBC,KAA9C,EAD4B,CAC0B;AACvD;AANC,kDAOKR,SAAS,CAAT,CAPL;;AAAA;AAAA,sBASEA,YAAYA,SAAS,CAAT,MAAc,EAT5B;AAAA;AAAA;AAAA;;AAAA,kDASuC,EAACW,SAAS,MAAV,EAAkBC,SAAS,YAA3B,EATvC;;AAAA;AAWJvB,sBAAM,IAAN,EAAY,kBAAZ;AAXI,kDAYG,EAACwB,OAAO,OAAR,EAAiBD,SAAS,iBAA1B,EAZH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAN;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAPK,GAAP;AAsBD;;QAEsBE,O,GAAdrB,U","file":"../../../fkpcore/router/passaccesscontrol.js","sourcesContent":["const DEBUG = debug('fkp:router:passaccesscontrol')\nconst AKSHOOKS = SAX('AOTOO-KOA-SERVER')\n\nfunction passaccess(oridata) {\n  return {\n    get: async function(ctx){\n      let passdata = await Fetch.get(ctx.fkproute, ctx.query)\n      passData = AKSHOOKS.emit('apiControl-get', { data: passdata, ctx }) || passdata\n      return passdata\n    },\n\n    post: async function(ctx){\n      let passdata = await Fetch.post(ctx.fkproute, ctx.request.body)\n      passData = AKSHOOKS.emit('apiControl-post', { data: passdata, ctx }) || passdata\n      if (passdata && passdata[1]) {\n        if (passdata[0].headers.login){\n          ctx.response.set('login', passdata[0].headers.login); //设置response的header\n        }\n        return passdata[1]\n      } else {\n        if (passdata && passdata[1]==='') return {success: '1010', message: \"链接正确，但数据为空\"}\n      }\n      DEBUG('%s', 'java/php后端返回数据出错')\n      return {error: \"60002\", message: \"java或者php返回数据错误\"}\n    }\n  }\n}\n\nexport { passaccess as getData }\n"]}